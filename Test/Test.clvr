/*-------------------------------------------------------------------------
    This source file is a part of Clover
    For the latest info, see https://github.com/cmarrin/Clover
    Copyright (c) 2021-2022, Chris Marrin
    All rights reserved.
    Use of this source code is governed by the MIT license that can be
    found in the LICENSE file.
-------------------------------------------------------------------------*/

def TestSizeDef 12;

const int testIntConst 4;
const float testFloatConst 3.5;

table int testIntTable
{
    1 2 3
    7 8 9
}

table float testFloatTable
{
    1.5 2.5 3.5
    7.5 8.5 9.5
}

var int testIntGlobal;
var float testFloatGlobal;

function showIntResults(int n, int exp, int act)
{
    log("    Test %i: ", n);
    if (exp != act) {
        log("*** FAILED: expected %i, got %i\n", exp, act);
    } else {
        log("Passed\n");
    }
}

function showFloatResults(int n, float exp, float act)
{
    log("    Test %i: ", n);
    if (exp != act) {
        log("*** FAILED: expected %f, got %f\n", exp, act);
    } else {
        log("Passed\n");
    }
}

function testInit()
{
    var int i;
    var float f;
    
    testFloatConst == 3.5;

    i = 1;
    testIntGlobal = 42;
    testFloatGlobal = 6.5;
    
    log("Test Init\n");
    
    log("\nInt Tests\n");
    showIntResults(1, 8,
        testIntTable[1] + TestSizeDef * testIntConst - testIntGlobal);

    log("\nFloat Tests \n");
    showFloatResults(1, 38.0,
        testFloatTable[1] + Float(TestSizeDef) * testFloatConst - testFloatGlobal);

    log("\nDone with Init tests\n\n");
}

function int testLoop()
{
    log("Test Loop\n");
    return 30;
}

command test 1 testInit testLoop;
